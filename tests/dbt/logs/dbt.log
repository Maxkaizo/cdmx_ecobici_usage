[0m12:06:57.519491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edfa7a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edebe5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edebe5c40>]}


============================== 12:06:57.524260 | 127e9626-b506-4acc-b6cd-756a1d6c0704 ==============================
[0m12:06:57.524260 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:06:57.524794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .dbt --select staging.stg_rides_enriched', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:07:00.214059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee105d910>]}
[0m12:07:00.290704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb110d850>]}
[0m12:07:00.291623 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:07:00.449292 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:07:00.449990 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:07:00.450459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eb108c220>]}
[0m12:07:01.374485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed954c130>]}
[0m12:07:01.425809 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:07:01.430858 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:07:01.460456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed9597ee0>]}
[0m12:07:01.460971 [info ] [MainThread]: Found 1 model, 491 macros
[0m12:07:01.461367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed94bf520>]}
[0m12:07:01.462644 [info ] [MainThread]: 
[0m12:07:01.463019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:01.463317 [info ] [MainThread]: 
[0m12:07:01.463863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:01.464944 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:07:01.465278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:02.518503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:07:02.519087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:03.634090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed6de7be0>]}
[0m12:07:03.634629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:03.640742 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:07:03.641402 [info ] [Thread-1  ]: 1 of 1 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m12:07:03.641988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:07:03.642688 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:07:03.655696 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:07:03.660246 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:07:03.690345 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:07:03.695189 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, timestamps and duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as int64) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as int64) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  timestamp_diff(
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500.ecobici_ds.stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m12:07:03.695656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:07:04.694407 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:31a0e015-4e2b-459f-bf00-25626523e3a6&page=queryresults
[0m12:07:04.695045 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:31a0e015-4e2b-459f-bf00-25626523e3a6&page=queryresults
[0m12:07:04.704391 [debug] [Thread-1  ]: Database Error in model stg_rides_enriched (models/staging/stg_rides_enriched.sql)
  Not found: Dataset dataeng-448500:ecobici_ds was not found in location us-central1
  compiled code at target/run/ecobici_dbt/models/staging/stg_rides_enriched.sql
[0m12:07:04.706445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '127e9626-b506-4acc-b6cd-756a1d6c0704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ed6df1640>]}
[0m12:07:04.707128 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dataeng_448500_ecobici_ds.stg_rides_enriched  [[31mERROR[0m in 1.06s]
[0m12:07:04.707832 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:07:04.708395 [debug] [Thread-4  ]: Marking all children of 'model.ecobici_dbt.stg_rides_enriched' to be skipped because of status 'error'.  Reason: Database Error in model stg_rides_enriched (models/staging/stg_rides_enriched.sql)
  Not found: Dataset dataeng-448500:ecobici_ds was not found in location us-central1
  compiled code at target/run/ecobici_dbt/models/staging/stg_rides_enriched.sql.
[0m12:07:04.709826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:04.711221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:04.711506 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:07:04.711784 [info ] [MainThread]: 
[0m12:07:04.712119 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m12:07:04.712695 [debug] [MainThread]: Command end result
[0m12:07:04.744899 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:07:04.747154 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:07:04.752718 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:07:04.753121 [info ] [MainThread]: 
[0m12:07:04.753499 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:07:04.753867 [info ] [MainThread]: 
[0m12:07:04.754235 [error] [MainThread]:   Database Error in model stg_rides_enriched (models/staging/stg_rides_enriched.sql)
  Not found: Dataset dataeng-448500:ecobici_ds was not found in location us-central1
  compiled code at target/run/ecobici_dbt/models/staging/stg_rides_enriched.sql
[0m12:07:04.754539 [info ] [MainThread]: 
[0m12:07:04.754858 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:07:04.755419 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.2975783, "process_in_blocks": "287952", "process_kernel_time": 1.274971, "process_mem_max_rss": "253436", "process_out_blocks": "2984", "process_user_time": 4.352831}
[0m12:07:04.755816 [debug] [MainThread]: Command `dbt run` failed at 12:07:04.755729 after 7.30 seconds
[0m12:07:04.756213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7edfa7a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ee049e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eda118b50>]}
[0m12:07:04.756562 [debug] [MainThread]: Flushing usage events
[0m12:07:05.232670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:27.562588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291645b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2915616520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2915616760>]}


============================== 12:08:27.567502 | 8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b ==============================
[0m12:08:27.567502 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:08:27.568181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .dbt --select staging.stg_rides_enriched', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:29.474047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e7a53880>]}
[0m12:08:29.538900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e7a59490>]}
[0m12:08:29.539633 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:08:29.720432 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:08:29.869721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:29.870489 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_rides_enriched.sql
[0m12:08:30.117592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290febf130>]}
[0m12:08:30.171068 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:08:30.177247 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:08:30.196430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290fedea00>]}
[0m12:08:30.196981 [info ] [MainThread]: Found 1 model, 491 macros
[0m12:08:30.197416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290ff1cac0>]}
[0m12:08:30.198713 [info ] [MainThread]: 
[0m12:08:30.199090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:30.199398 [info ] [MainThread]: 
[0m12:08:30.199885 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:08:30.200863 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:08:30.201442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:31.044244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:08:31.044769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:32.049297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290ff31af0>]}
[0m12:08:32.049824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:32.055001 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:08:32.055679 [info ] [Thread-1  ]: 1 of 1 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m12:08:32.056226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:08:32.056555 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:08:32.062833 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:08:32.063780 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:08:32.085727 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:08:32.086561 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, timestamps and duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as int64) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as int64) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  timestamp_diff(
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_timestamp('%Y-%m-%d %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500.dataeng_448500_ecobici_ds.stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m12:08:32.087021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:08:33.190500 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:7148c2ae-497c-423b-97e0-1b0620f13007&page=queryresults
[0m12:08:33.670608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f4f114b-2818-4e40-b3cc-4c7d6a8eac5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290d791f40>]}
[0m12:08:33.671465 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m12:08:33.672242 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:08:33.673768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:33.675226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:33.675515 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:08:33.675794 [info ] [MainThread]: 
[0m12:08:33.676111 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m12:08:33.676727 [debug] [MainThread]: Command end result
[0m12:08:33.695384 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:08:33.696909 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:08:33.701928 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:08:33.702366 [info ] [MainThread]: 
[0m12:08:33.702743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:08:33.703033 [info ] [MainThread]: 
[0m12:08:33.703349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:08:33.703940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2034087, "process_in_blocks": "281320", "process_kernel_time": 0.589397, "process_mem_max_rss": "253576", "process_out_blocks": "2968", "process_user_time": 3.892053}
[0m12:08:33.704318 [debug] [MainThread]: Command `dbt run` succeeded at 12:08:33.704234 after 6.20 seconds
[0m12:08:33.704661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291645b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28e7a53880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2910abfb20>]}
[0m12:08:33.704996 [debug] [MainThread]: Flushing usage events
[0m12:08:34.206636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:27.962606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51382ca3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51373e6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51373e6d30>]}


============================== 12:15:27.967772 | 8e6754a9-48ea-4913-8802-73bdcdf018e7 ==============================
[0m12:15:27.967772 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:15:27.968302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .dbt --select staging.stg_rides_enriched', 'send_anonymous_usage_stats': 'True'}
[0m12:15:29.882949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e6754a9-48ea-4913-8802-73bdcdf018e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51398ad220>]}
[0m12:15:29.940608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e6754a9-48ea-4913-8802-73bdcdf018e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51380d6b50>]}
[0m12:15:29.941270 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:15:30.082873 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:15:30.209878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:30.210470 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_rides_enriched.sql
[0m12:15:30.446802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e6754a9-48ea-4913-8802-73bdcdf018e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131cbf130>]}
[0m12:15:30.498624 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:15:30.504124 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:15:30.523576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e6754a9-48ea-4913-8802-73bdcdf018e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131cdafd0>]}
[0m12:15:30.524096 [info ] [MainThread]: Found 1 model, 491 macros
[0m12:15:30.524471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6754a9-48ea-4913-8802-73bdcdf018e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131d20820>]}
[0m12:15:30.525576 [info ] [MainThread]: 
[0m12:15:30.525925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:30.526263 [info ] [MainThread]: 
[0m12:15:30.526815 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:15:30.527721 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:15:30.528139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:31.559483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:15:31.560020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:32.096951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e6754a9-48ea-4913-8802-73bdcdf018e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5131d34310>]}
[0m12:15:32.097658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:32.102427 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:15:32.103080 [info ] [Thread-1  ]: 1 of 1 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m12:15:32.103691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:15:32.104140 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:15:32.109963 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:15:32.110721 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:15:32.133447 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:15:32.134182 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, timestamps and duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as int64) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_timestamp('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as int64) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_timestamp('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  timestamp_diff(
    safe.parse_timestamp('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_timestamp('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500.dataeng_448500_ecobici_ds.stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m12:15:32.134585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:15:32.797494 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:17291de3-9bf0-4594-a96d-361236344752&page=queryresults
[0m12:15:33.211041 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e6754a9-48ea-4913-8802-73bdcdf018e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f512f5cddf0>]}
[0m12:15:33.211966 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m12:15:33.212630 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:15:33.214407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:33.216255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:33.216685 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:15:33.217093 [info ] [MainThread]: 
[0m12:15:33.217468 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m12:15:33.218127 [debug] [MainThread]: Command end result
[0m12:15:33.238050 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:15:33.239837 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:15:33.244799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:15:33.245124 [info ] [MainThread]: 
[0m12:15:33.245586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:33.245901 [info ] [MainThread]: 
[0m12:15:33.246226 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:15:33.246832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3416505, "process_in_blocks": "276920", "process_kernel_time": 0.551285, "process_mem_max_rss": "255692", "process_out_blocks": "2968", "process_user_time": 3.740863}
[0m12:15:33.247210 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:33.247125 after 5.34 seconds
[0m12:15:33.247577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51382ca3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51398ad220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513292d730>]}
[0m12:15:33.247909 [debug] [MainThread]: Flushing usage events
[0m12:15:33.713896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:09.973528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc6518490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc63381c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc56838b0>]}


============================== 12:19:09.977909 | d01c0ed0-04bb-4edc-a88f-7b65b1561f06 ==============================
[0m12:19:09.977909 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:19:09.978428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .dbt --select staging.stg_rides_enriched', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:19:11.822599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd01c0ed0-04bb-4edc-a88f-7b65b1561f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc56e5a60>]}
[0m12:19:11.880896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd01c0ed0-04bb-4edc-a88f-7b65b1561f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc7d02040>]}
[0m12:19:11.881634 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:19:12.023229 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:19:12.146995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:12.147635 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_rides_enriched.sql
[0m12:19:12.377214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd01c0ed0-04bb-4edc-a88f-7b65b1561f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbfebbe50>]}
[0m12:19:12.427830 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:19:12.432924 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:19:12.450690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd01c0ed0-04bb-4edc-a88f-7b65b1561f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc0c83370>]}
[0m12:19:12.451211 [info ] [MainThread]: Found 1 model, 491 macros
[0m12:19:12.451581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01c0ed0-04bb-4edc-a88f-7b65b1561f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed979b5af0>]}
[0m12:19:12.452663 [info ] [MainThread]: 
[0m12:19:12.453061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:12.453355 [info ] [MainThread]: 
[0m12:19:12.453860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:19:12.454783 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:19:12.455354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:13.280177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:19:13.280735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:14.189438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd01c0ed0-04bb-4edc-a88f-7b65b1561f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbff027f0>]}
[0m12:19:14.189942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:14.194327 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:19:14.194897 [info ] [Thread-1  ]: 1 of 1 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m12:19:14.195324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:19:14.195625 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:19:14.201292 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:19:14.201932 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:19:14.224877 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:19:14.225666 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, local datetime and ride duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as int64) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as int64) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  datetime_diff(
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500.dataeng_448500_ecobici_ds.stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m12:19:14.226087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:15.235330 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:2df703d7-4e06-4305-9145-a7fa9f23858f&page=queryresults
[0m12:19:15.673086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd01c0ed0-04bb-4edc-a88f-7b65b1561f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbd78b2b0>]}
[0m12:19:15.673947 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m12:19:15.674601 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:19:15.675851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:15.677072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:15.677347 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:19:15.677643 [info ] [MainThread]: 
[0m12:19:15.677967 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m12:19:15.678527 [debug] [MainThread]: Command end result
[0m12:19:15.697596 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:19:15.699195 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:19:15.704112 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:19:15.704454 [info ] [MainThread]: 
[0m12:19:15.704874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:15.705176 [info ] [MainThread]: 
[0m12:19:15.705498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:19:15.706026 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7891116, "process_in_blocks": "276800", "process_kernel_time": 0.710127, "process_mem_max_rss": "253760", "process_out_blocks": "2968", "process_user_time": 3.570639}
[0m12:19:15.706415 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:15.706330 after 5.79 seconds
[0m12:19:15.706782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc6518490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc56e5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedc0941730>]}
[0m12:19:15.707117 [debug] [MainThread]: Flushing usage events
[0m12:19:16.126853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:01.681066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b117943d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b108fec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b11536b20>]}


============================== 12:25:01.687475 | 294a9c97-6564-477c-abf2-9e142c134225 ==============================
[0m12:25:01.687475 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:25:01.688148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .dbt', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:25:03.539151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '294a9c97-6564-477c-abf2-9e142c134225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b10907670>]}
[0m12:25:03.598284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '294a9c97-6564-477c-abf2-9e142c134225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b12f906d0>]}
[0m12:25:03.599032 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:25:03.752211 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:25:03.876636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:03.877067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:03.899772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '294a9c97-6564-477c-abf2-9e142c134225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0bee0130>]}
[0m12:25:03.921965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '294a9c97-6564-477c-abf2-9e142c134225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0be955b0>]}
[0m12:25:03.922485 [info ] [MainThread]: Found 1 model, 491 macros
[0m12:25:03.922803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '294a9c97-6564-477c-abf2-9e142c134225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0be954f0>]}
[0m12:25:03.924012 [info ] [MainThread]: 
[0m12:25:03.924353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:03.924639 [info ] [MainThread]: 
[0m12:25:03.925105 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:25:03.925927 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500_dataeng_448500_ecobici_ds'
[0m12:25:03.926320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:04.793364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '294a9c97-6564-477c-abf2-9e142c134225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0beafac0>]}
[0m12:25:04.793836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:04.798389 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:25:04.798774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:25:04.799072 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:25:04.806020 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:25:04.807052 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:25:04.807597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:25:04.809341 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:25:04.810489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:04.810753 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:25:04.811284 [debug] [MainThread]: Command end result
[0m12:25:04.861499 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:25:04.866222 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:25:04.872156 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:25:04.878858 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:25:04.879257 [info ] [MainThread]: Building catalog
[0m12:25:04.880631 [debug] [ThreadPool]: Acquiring new bigquery connection 'dataeng-448500.information_schema'
[0m12:25:04.895336 [debug] [ThreadPool]: On dataeng-448500.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "connection_name": "dataeng-448500.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.__TABLES__ tables
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides_enriched')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMNS columns
    join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:25:04.896472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:05.697471 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:82b00bc7-3f74-4d22-8e6b-fba55657018c&page=queryresults
[0m12:25:07.383466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:07.392847 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:25:07.411895 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:25:07.413359 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:25:07.413641 [info ] [MainThread]: Catalog written to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:25:07.414241 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.7890143, "process_in_blocks": "280864", "process_kernel_time": 0.570533, "process_mem_max_rss": "253044", "process_out_blocks": "5344", "process_user_time": 3.492059}
[0m12:25:07.414631 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:25:07.414548 after 5.79 seconds
[0m12:25:07.414924 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:25:07.415260 [debug] [MainThread]: Connection 'dataeng-448500.information_schema' was properly closed.
[0m12:25:07.415556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b117943d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b10907670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0beaf370>]}
[0m12:25:07.415877 [debug] [MainThread]: Flushing usage events
[0m12:25:07.833936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:01.450374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4fda7a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4fcbe0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4fcbe0b50>]}


============================== 12:26:01.455547 | f964fe83-4b85-46e2-8699-4f7ad40055fc ==============================
[0m12:26:01.455547 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:26:01.456205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:03.305579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f964fe83-4b85-46e2-8699-4f7ad40055fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ff05d640>]}
[0m12:26:03.365262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f964fe83-4b85-46e2-8699-4f7ad40055fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ff2280a0>]}
[0m12:26:03.365981 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:26:03.509314 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:26:03.631135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:26:03.631721 [debug] [MainThread]: Partial parsing: added file: ecobici_dbt://models/staging/schema.yml
[0m12:26:03.752894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f964fe83-4b85-46e2-8699-4f7ad40055fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7fb3ee0>]}
[0m12:26:03.773219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f964fe83-4b85-46e2-8699-4f7ad40055fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7fc37f0>]}
[0m12:26:03.773786 [info ] [MainThread]: Found 1 model, 491 macros
[0m12:26:03.774178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f964fe83-4b85-46e2-8699-4f7ad40055fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7fc3730>]}
[0m12:26:03.775678 [info ] [MainThread]: 
[0m12:26:03.776056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:03.776386 [info ] [MainThread]: 
[0m12:26:03.777141 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:26:03.778018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500_dataeng_448500_ecobici_ds'
[0m12:26:03.778420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:04.698023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f964fe83-4b85-46e2-8699-4f7ad40055fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7fc38b0>]}
[0m12:26:04.698619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:04.703340 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:26:04.703744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:26:04.704079 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:26:04.709369 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:26:04.709902 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:26:04.710265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:26:04.711759 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:26:04.712951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:04.713222 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:26:04.713718 [debug] [MainThread]: Command end result
[0m12:26:04.763572 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:26:04.768862 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:26:04.773992 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:26:04.781734 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:26:04.782315 [info ] [MainThread]: Building catalog
[0m12:26:04.783838 [debug] [ThreadPool]: Acquiring new bigquery connection 'dataeng-448500.information_schema'
[0m12:26:04.799338 [debug] [ThreadPool]: On dataeng-448500.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "connection_name": "dataeng-448500.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.__TABLES__ tables
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides_enriched')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMNS columns
    join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:26:04.800550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:05.862597 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:623297d7-da5d-4c61-b353-34381c8f9733&page=queryresults
[0m12:26:07.541474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:07.551211 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:26:07.570054 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:26:07.571447 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:26:07.571759 [info ] [MainThread]: Catalog written to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:26:07.572360 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.1817675, "process_in_blocks": "280024", "process_kernel_time": 0.361584, "process_mem_max_rss": "253696", "process_out_blocks": "6320", "process_user_time": 3.677835}
[0m12:26:07.572757 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:26:07.572673 after 6.18 seconds
[0m12:26:07.573054 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:26:07.573326 [debug] [MainThread]: Connection 'dataeng-448500.information_schema' was properly closed.
[0m12:26:07.573626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4fda7a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ff05d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f7f5d0d0>]}
[0m12:26:07.573965 [debug] [MainThread]: Flushing usage events
[0m12:26:07.986220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:13.378194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb15d763430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb15c87e370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb15c87e3d0>]}


============================== 12:26:13.381254 | cf3fbc83-0f5f-4f82-8b7a-934573b6763e ==============================
[0m12:26:13.381254 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:26:13.381721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'profiles_dir': '.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve --profiles-dir .dbt --port 8081', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:26:14.310999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf3fbc83-0f5f-4f82-8b7a-934573b6763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12edf52e0>]}
[0m12:26:14.366561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf3fbc83-0f5f-4f82-8b7a-934573b6763e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb15d57ab20>]}
[0m12:26:15.148793 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m12:26:15.151338 [error] [MainThread]: Traceback (most recent call last):
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m12:26:15.151988 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.8250595, "process_in_blocks": "1216", "process_kernel_time": 0.233876, "process_mem_max_rss": "254444", "process_out_blocks": "3352", "process_user_time": 2.847191}
[0m12:26:15.152425 [debug] [MainThread]: Command `dbt docs serve` failed at 12:26:15.152334 after 1.83 seconds
[0m12:26:15.152825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb15d763430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12ec1b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb12ed778e0>]}
[0m12:26:15.153220 [debug] [MainThread]: Flushing usage events
[0m12:26:15.771174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:24.405139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6dc72d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6db848370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6db8483d0>]}


============================== 12:26:24.407890 | 67cb9996-f9cb-4d2b-b81e-8238a24df393 ==============================
[0m12:26:24.407890 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:26:24.408345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'profiles_dir': '.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve --profiles-dir .dbt --port 8090', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:25.361860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67cb9996-f9cb-4d2b-b81e-8238a24df393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6addc4bb0>]}
[0m12:26:25.419101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67cb9996-f9cb-4d2b-b81e-8238a24df393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6db8ee130>]}
[0m12:29:43.589342 [error] [MainThread]: Encountered an error:

[0m12:29:43.606135 [error] [MainThread]: Traceback (most recent call last):
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:29:43.607217 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 198.22859, "process_in_blocks": "864", "process_kernel_time": 0.252448, "process_mem_max_rss": "254860", "process_out_blocks": "3352", "process_user_time": 2.894103}
[0m12:29:43.607775 [debug] [MainThread]: Command `dbt docs serve` failed at 12:29:43.607625 after 198.23 seconds
[0m12:29:43.608443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6dc72d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6adb74700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6adba9610>]}
[0m12:29:43.609108 [debug] [MainThread]: Flushing usage events
[0m12:29:44.522367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:46.488341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dccd144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcbe2ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcbe2fee0>]}


============================== 12:31:46.492800 | 7462e9aa-d6f4-4181-b104-16d45941e0eb ==============================
[0m12:31:46.492800 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:31:46.493438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir .dbt --select staging.stg_rides_enriched', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:31:48.304544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7462e9aa-d6f4-4181-b104-16d45941e0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dce2f7850>]}
[0m12:31:48.359403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7462e9aa-d6f4-4181-b104-16d45941e0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9e3a7b80>]}
[0m12:31:48.360068 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:31:48.497066 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:31:48.626034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:31:48.626823 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/schema.yml
[0m12:31:48.627230 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_rides_enriched.sql
[0m12:31:49.014030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7462e9aa-d6f4-4181-b104-16d45941e0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dc3e91280>]}
[0m12:31:49.071171 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:31:49.075422 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:31:49.093364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7462e9aa-d6f4-4181-b104-16d45941e0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dc3eadfd0>]}
[0m12:31:49.093899 [info ] [MainThread]: Found 1 model, 1 source, 491 macros
[0m12:31:49.094280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7462e9aa-d6f4-4181-b104-16d45941e0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dc3ead3a0>]}
[0m12:31:49.095464 [info ] [MainThread]: 
[0m12:31:49.095863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:49.096158 [info ] [MainThread]: 
[0m12:31:49.096672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:31:49.097535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:31:49.097971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:50.003078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:31:50.003585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:50.910865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7462e9aa-d6f4-4181-b104-16d45941e0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dc733c9d0>]}
[0m12:31:50.911347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:50.915597 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:31:50.916082 [info ] [Thread-1  ]: 1 of 1 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m12:31:50.916481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:31:50.916828 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:31:50.923319 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:31:50.924625 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:31:50.945658 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:31:50.946869 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, local datetime and ride duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as int64) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as int64) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  datetime_diff(
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m12:31:50.947476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:31:51.992564 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:b41d9e95-f620-4be3-b435-fde0d951cfa0&page=queryresults
[0m12:31:52.497437 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7462e9aa-d6f4-4181-b104-16d45941e0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dccece5e0>]}
[0m12:31:52.498308 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m12:31:52.498892 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:31:52.500531 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:52.501999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:52.502278 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:31:52.502554 [info ] [MainThread]: 
[0m12:31:52.502939 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m12:31:52.503507 [debug] [MainThread]: Command end result
[0m12:31:52.522683 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:31:52.524400 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:31:52.528996 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:31:52.529319 [info ] [MainThread]: 
[0m12:31:52.529780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:52.530113 [info ] [MainThread]: 
[0m12:31:52.530459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:31:52.531106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.097682, "process_in_blocks": "276960", "process_kernel_time": 0.371342, "process_mem_max_rss": "258456", "process_out_blocks": "2992", "process_user_time": 4.063327}
[0m12:31:52.531478 [debug] [MainThread]: Command `dbt run` succeeded at 12:31:52.531392 after 6.10 seconds
[0m12:31:52.531813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dccd144f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dce2f7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dc3eadfd0>]}
[0m12:31:52.532151 [debug] [MainThread]: Flushing usage events
[0m12:31:53.027523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:00.717960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bda154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bd836280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bcb7cb80>]}


============================== 12:32:00.721048 | fd000e1a-6d1c-4b0d-8567-dcb4d47a6d1c ==============================
[0m12:32:00.721048 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:32:00.721567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'profiles_dir': '.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:32:01.707829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd000e1a-6d1c-4b0d-8567-dcb4d47a6d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888f04b400>]}
[0m12:32:01.764956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd000e1a-6d1c-4b0d-8567-dcb4d47a6d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bf1d1580>]}
[0m12:32:01.765673 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:32:01.898249 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:32:01.990407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:32:01.990861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:32:02.020840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd000e1a-6d1c-4b0d-8567-dcb4d47a6d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b8089130>]}
[0m12:32:02.031808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd000e1a-6d1c-4b0d-8567-dcb4d47a6d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b80f7d90>]}
[0m12:32:02.032344 [info ] [MainThread]: Found 1 model, 1 source, 491 macros
[0m12:32:02.032716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd000e1a-6d1c-4b0d-8567-dcb4d47a6d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b80f7bb0>]}
[0m12:32:02.034046 [info ] [MainThread]: 
[0m12:32:02.034392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:02.034813 [info ] [MainThread]: 
[0m12:32:02.035356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:32:02.036176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500_dataeng_448500_ecobici_ds'
[0m12:32:02.036560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:02.952836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd000e1a-6d1c-4b0d-8567-dcb4d47a6d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b8041070>]}
[0m12:32:02.953395 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:02.957655 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:32:02.958104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:32:02.958421 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:32:02.965448 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:32:02.966041 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:32:02.966388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:32:02.967878 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:32:02.969011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:02.969281 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:32:02.969888 [debug] [MainThread]: Command end result
[0m12:32:03.032984 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:32:03.037613 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:32:03.042984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:32:03.050228 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:32:03.050685 [info ] [MainThread]: Building catalog
[0m12:32:03.055690 [debug] [ThreadPool]: Acquiring new bigquery connection 'dataeng-448500.information_schema'
[0m12:32:03.076212 [debug] [ThreadPool]: On dataeng-448500.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "connection_name": "dataeng-448500.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.__TABLES__ tables
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides')
                            ) or (
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides_enriched')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMNS columns
    join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:32:03.077180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:04.181068 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:1c3336eb-2fe1-437d-839f-5c9508d2bbe8&page=queryresults
[0m12:32:05.986389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:32:05.996706 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:32:06.017517 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:32:06.019255 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:32:06.019664 [info ] [MainThread]: Catalog written to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:32:06.020773 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.356052, "process_in_blocks": "3384", "process_kernel_time": 0.25882, "process_mem_max_rss": "254284", "process_out_blocks": "5352", "process_user_time": 3.31149}
[0m12:32:06.021259 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:32:06.021168 after 5.36 seconds
[0m12:32:06.021586 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:32:06.021877 [debug] [MainThread]: Connection 'dataeng-448500.information_schema' was properly closed.
[0m12:32:06.022189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bda154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888f04b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b80f7d90>]}
[0m12:32:06.022531 [debug] [MainThread]: Flushing usage events
[0m12:32:06.504986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:13.698489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d96ee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8809130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d8809190>]}


============================== 12:32:13.701772 | 269985ce-a070-47c0-94be-23e20114bc8b ==============================
[0m12:32:13.701772 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:32:13.702452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve --profiles-dir .dbt --port 8090', 'send_anonymous_usage_stats': 'True'}
[0m12:32:14.647327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '269985ce-a070-47c0-94be-23e20114bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5aacc2a00>]}
[0m12:32:14.704467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '269985ce-a070-47c0-94be-23e20114bc8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d9578910>]}
[0m12:33:45.789522 [error] [MainThread]: Encountered an error:

[0m12:33:45.794562 [error] [MainThread]: Traceback (most recent call last):
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:33:45.795378 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 91.64068, "process_in_blocks": "376", "process_kernel_time": 0.335917, "process_mem_max_rss": "254668", "process_out_blocks": "3360", "process_user_time": 2.853131}
[0m12:33:45.795975 [debug] [MainThread]: Command `dbt docs serve` failed at 12:33:45.795856 after 91.64 seconds
[0m12:33:45.796668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d96ee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5aab62ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5aab38580>]}
[0m12:33:45.797144 [debug] [MainThread]: Flushing usage events
[0m12:33:46.584483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:04.276547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2ee494f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2ec69fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2dfcd340>]}


============================== 12:48:04.282798 | 3c6f018e-c815-44bb-9529-d1d96bd80846 ==============================
[0m12:48:04.282798 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:04.283556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate --profiles-dir .dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:48:06.655636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c6f018e-c815-44bb-9529-d1d96bd80846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c004cd820>]}
[0m12:48:06.717316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c6f018e-c815-44bb-9529-d1d96bd80846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2e064520>]}
[0m12:48:06.718029 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:48:06.864075 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:48:07.014498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:48:07.015077 [debug] [MainThread]: Partial parsing: added file: ecobici_dbt://models/staging/stg_stations.sql
[0m12:48:07.015602 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/schema.yml
[0m12:48:07.423543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c6f018e-c815-44bb-9529-d1d96bd80846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c260aa130>]}
[0m12:48:07.445925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c6f018e-c815-44bb-9529-d1d96bd80846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c26090bb0>]}
[0m12:48:07.446476 [info ] [MainThread]: Found 2 models, 2 sources, 491 macros
[0m12:48:07.446815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c6f018e-c815-44bb-9529-d1d96bd80846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c26090b20>]}
[0m12:48:07.448282 [info ] [MainThread]: 
[0m12:48:07.448740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:07.449037 [info ] [MainThread]: 
[0m12:48:07.449582 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:48:07.453363 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500_dataeng_448500_ecobici_ds'
[0m12:48:07.454116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:08.412105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c6f018e-c815-44bb-9529-d1d96bd80846', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2dfa77c0>]}
[0m12:48:08.412589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:08.418676 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:48:08.419248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:48:08.419575 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:48:08.425705 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:48:08.426377 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:48:08.426743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:48:08.428197 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:48:08.428537 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_stations
[0m12:48:08.428998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_rides_enriched, now model.ecobici_dbt.stg_stations)
[0m12:48:08.429291 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_stations
[0m12:48:08.431695 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_stations"
[0m12:48:08.432304 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_stations
[0m12:48:08.432669 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:48:08.434058 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_stations
[0m12:48:08.435216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:08.435485 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_stations' was properly closed.
[0m12:48:08.436072 [debug] [MainThread]: Command end result
[0m12:48:08.497496 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:48:08.502350 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:48:08.507413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:48:08.518140 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:48:08.518700 [info ] [MainThread]: Building catalog
[0m12:48:08.523456 [debug] [ThreadPool]: Acquiring new bigquery connection 'dataeng-448500.information_schema'
[0m12:48:08.538303 [debug] [ThreadPool]: On dataeng-448500.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "connection_name": "dataeng-448500.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.__TABLES__ tables
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides')
                            ) or (
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides_enriched')
                            ) or (
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_stations')
                            ) or (
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('dim_stations')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMNS columns
    join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:48:08.539065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:09.606483 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:0fc72a46-9316-4397-abf2-9e0aaf5cefdb&page=queryresults
[0m12:48:11.062757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:11.074592 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:48:11.096370 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:48:11.097861 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:48:11.098138 [info ] [MainThread]: Catalog written to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:48:11.098740 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.8804727, "process_in_blocks": "280536", "process_kernel_time": 0.844617, "process_mem_max_rss": "253656", "process_out_blocks": "6400", "process_user_time": 4.184695}
[0m12:48:11.099117 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:48:11.099033 after 6.88 seconds
[0m12:48:11.099428 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:48:11.099701 [debug] [MainThread]: Connection 'dataeng-448500.information_schema' was properly closed.
[0m12:48:11.100001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2ee494f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c26094220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c26047220>]}
[0m12:48:11.100325 [debug] [MainThread]: Flushing usage events
[0m12:48:11.587171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:13.083226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b7b9b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b9353790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b6d9f730>]}


============================== 12:48:13.086333 | c14c05c0-9212-4f98-9cd5-fbe9c728cfb2 ==============================
[0m12:48:13.086333 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:13.086870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --profiles-dir .dbt --port 8090', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:14.020256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c14c05c0-9212-4f98-9cd5-fbe9c728cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b79b33a0>]}
[0m12:48:14.078535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c14c05c0-9212-4f98-9cd5-fbe9c728cfb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19891aaa30>]}
[0m12:49:17.376158 [error] [MainThread]: Encountered an error:

[0m12:49:17.379651 [error] [MainThread]: Traceback (most recent call last):
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:49:17.380455 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 64.03418, "process_in_blocks": "5760", "process_kernel_time": 0.372787, "process_mem_max_rss": "252988", "process_out_blocks": "3360", "process_user_time": 2.757198}
[0m12:49:17.380950 [debug] [MainThread]: Command `dbt docs serve` failed at 12:49:17.380849 after 64.03 seconds
[0m12:49:17.381764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19b7b9b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1988fbc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1989060880>]}
[0m12:49:17.382314 [debug] [MainThread]: Flushing usage events
[0m12:49:18.084448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:31.146659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5ceb2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5c088d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5c088d90>]}


============================== 12:49:31.150515 | f5140fb9-aa36-4637-817e-b5035efd14cf ==============================
[0m12:49:31.150515 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:31.151070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'profiles_dir': '.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .dbt --select staging.stg_rides_enriched', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:32.911261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5140fb9-aa36-4637-817e-b5035efd14cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5e4952b0>]}
[0m12:49:32.970133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5140fb9-aa36-4637-817e-b5035efd14cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5e5f44f0>]}
[0m12:49:32.970970 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:49:33.111706 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:33.261816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:33.262305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:33.294302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5140fb9-aa36-4637-817e-b5035efd14cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5748a130>]}
[0m12:49:33.360688 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:49:33.366441 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:49:33.385560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5140fb9-aa36-4637-817e-b5035efd14cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e3013d0>]}
[0m12:49:33.386166 [info ] [MainThread]: Found 2 models, 2 sources, 491 macros
[0m12:49:33.386499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5140fb9-aa36-4637-817e-b5035efd14cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe574895b0>]}
[0m12:49:33.388088 [info ] [MainThread]: 
[0m12:49:33.388445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:33.388872 [info ] [MainThread]: 
[0m12:49:33.389435 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:49:33.390359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:49:33.390818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:34.339165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:49:34.339898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:34.917763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5140fb9-aa36-4637-817e-b5035efd14cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2e4651c0>]}
[0m12:49:34.918389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:34.924270 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:49:34.924930 [info ] [Thread-1  ]: 1 of 1 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m12:49:34.925435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:49:34.925773 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:49:34.934556 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:49:34.936773 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:49:34.959013 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:49:34.960190 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, local datetime and ride duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as int64) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as int64) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  datetime_diff(
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m12:49:34.960614 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:49:35.817019 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:134780b9-2000-4bda-be6d-96aef88ccf3a&page=queryresults
[0m12:49:36.248015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5140fb9-aa36-4637-817e-b5035efd14cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe574b60d0>]}
[0m12:49:36.248873 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m12:49:36.249619 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:49:36.251582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:36.253242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:36.253603 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_rides_enriched' was properly closed.
[0m12:49:36.254127 [info ] [MainThread]: 
[0m12:49:36.254523 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m12:49:36.255358 [debug] [MainThread]: Command end result
[0m12:49:36.276872 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:49:36.278434 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:49:36.283302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:49:36.283673 [info ] [MainThread]: 
[0m12:49:36.284231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:36.284659 [info ] [MainThread]: 
[0m12:49:36.285012 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:36.285602 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.043851, "process_in_blocks": "108520", "process_kernel_time": 0.557687, "process_mem_max_rss": "252932", "process_out_blocks": "2016", "process_user_time": 3.427242}
[0m12:49:36.286008 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:36.285899 after 5.04 seconds
[0m12:49:36.286363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5ceb2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5e4952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe5749a1f0>]}
[0m12:49:36.286704 [debug] [MainThread]: Flushing usage events
[0m12:49:36.799165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:07.532010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c9b5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c757c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33bcfebe0>]}


============================== 12:50:07.535379 | 4a5083b2-20dd-410f-9b6d-16c2fdbdfc07 ==============================
[0m12:50:07.535379 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:07.536092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.dbt', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir .dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:08.541762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30df927f0>]}
[0m12:50:08.598155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c83f910>]}
[0m12:50:08.598896 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:50:08.734046 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:50:08.824238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:08.824682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:08.855844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33708a130>]}
[0m12:50:08.925816 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:50:08.929866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:50:08.938277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33708a430>]}
[0m12:50:08.938782 [info ] [MainThread]: Found 2 models, 2 sources, 491 macros
[0m12:50:08.939136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33708a250>]}
[0m12:50:08.940911 [info ] [MainThread]: 
[0m12:50:08.941292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:08.941599 [info ] [MainThread]: 
[0m12:50:08.942098 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:50:08.945747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:50:08.946351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:09.590989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:50:09.591502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:10.237199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33bb2f100>]}
[0m12:50:10.237839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:10.242262 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:50:10.242776 [info ] [Thread-1  ]: 1 of 2 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m12:50:10.243256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:50:10.243589 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:50:10.251607 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:50:10.252766 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:50:10.275851 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:50:10.276885 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, local datetime and ride duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as int64) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as int64) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  datetime_diff(
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m12:50:10.277395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:50:11.087839 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:ab0beec6-e468-49c1-a91f-bc02384f5380&page=queryresults
[0m12:50:11.450669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3370b6370>]}
[0m12:50:11.451357 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m12:50:11.451903 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:50:11.452269 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_stations
[0m12:50:11.452794 [info ] [Thread-1  ]: 2 of 2 START sql view model dataeng_448500_ecobici_ds.stg_stations ............. [RUN]
[0m12:50:11.453275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_rides_enriched, now model.ecobici_dbt.stg_stations)
[0m12:50:11.453583 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_stations
[0m12:50:11.456519 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_stations"
[0m12:50:11.457080 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_stations
[0m12:50:11.459365 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_stations"
[0m12:50:11.460528 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_stations"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations`
  OPTIONS()
  as -- models/staging/stg_stations.sql
-- Staging model for the Ecobici station catalog

select
  station_id,
  name,
  short_name,
  lat,
  lon,
  capacity,
  is_charging,
  has_kiosk,
  ingestion_ts
from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`dim_stations`;


[0m12:50:11.460874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:50:12.100442 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:ee4a1dc6-e04a-47b1-b5a8-92f174b91f27&page=queryresults
[0m12:50:12.440967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5083b2-20dd-410f-9b6d-16c2fdbdfc07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c82ffd0>]}
[0m12:50:12.441716 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dataeng_448500_ecobici_ds.stg_stations ........ [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m12:50:12.442324 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_stations
[0m12:50:12.443887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:50:12.445151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:12.445505 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_stations' was properly closed.
[0m12:50:12.445827 [info ] [MainThread]: 
[0m12:50:12.446168 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m12:50:12.446846 [debug] [MainThread]: Command end result
[0m12:50:12.465710 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:50:12.467192 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:50:12.472075 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:50:12.472424 [info ] [MainThread]: 
[0m12:50:12.472789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:12.473086 [info ] [MainThread]: 
[0m12:50:12.473424 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:50:12.473961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.997039, "process_in_blocks": "16", "process_kernel_time": 0.417787, "process_mem_max_rss": "251828", "process_out_blocks": "2048", "process_user_time": 3.272668}
[0m12:50:12.474332 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:12.474248 after 5.00 seconds
[0m12:50:12.474671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33c9b5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe30df927f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33d3d96a0>]}
[0m12:50:12.475005 [debug] [MainThread]: Flushing usage events
[0m12:50:12.858490 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:20.227599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa432b67490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa431c82220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa431c82280>]}


============================== 12:53:20.233315 | 81bef326-5a5b-44cd-b984-1663af1f9ffa ==============================
[0m12:53:20.233315 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:53:20.233884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir .dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:22.075855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81bef326-5a5b-44cd-b984-1663af1f9ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa431d14520>]}
[0m12:53:22.134446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81bef326-5a5b-44cd-b984-1663af1f9ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4329fdbb0>]}
[0m12:53:22.135131 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:53:22.272249 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:53:22.415922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:22.416721 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/schema.yml
[0m12:53:22.822976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81bef326-5a5b-44cd-b984-1663af1f9ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa429c80fa0>]}
[0m12:53:22.843997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81bef326-5a5b-44cd-b984-1663af1f9ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa429c3c0a0>]}
[0m12:53:22.844573 [info ] [MainThread]: Found 2 models, 2 sources, 491 macros
[0m12:53:22.844951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81bef326-5a5b-44cd-b984-1663af1f9ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa429c9d730>]}
[0m12:53:22.846307 [info ] [MainThread]: 
[0m12:53:22.846658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:22.846962 [info ] [MainThread]: 
[0m12:53:22.847466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:53:22.852591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500_dataeng_448500_ecobici_ds'
[0m12:53:22.853130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:23.382138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81bef326-5a5b-44cd-b984-1663af1f9ffa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa431cc63d0>]}
[0m12:53:23.382704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:23.387173 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m12:53:23.387662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m12:53:23.388007 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m12:53:23.394435 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m12:53:23.395375 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m12:53:23.395735 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:23.397220 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m12:53:23.397576 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_stations
[0m12:53:23.398014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_rides_enriched, now model.ecobici_dbt.stg_stations)
[0m12:53:23.398301 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_stations
[0m12:53:23.400866 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_stations"
[0m12:53:23.401329 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_stations
[0m12:53:23.401656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:23.402970 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_stations
[0m12:53:23.404018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:23.404293 [debug] [MainThread]: Connection 'model.ecobici_dbt.stg_stations' was properly closed.
[0m12:53:23.405015 [debug] [MainThread]: Command end result
[0m12:53:23.464212 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:53:23.468789 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:53:23.474124 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:53:23.482546 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:53:23.483011 [info ] [MainThread]: Building catalog
[0m12:53:23.488649 [debug] [ThreadPool]: Acquiring new bigquery connection 'dataeng-448500.information_schema'
[0m12:53:23.503339 [debug] [ThreadPool]: On dataeng-448500.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "connection_name": "dataeng-448500.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.__TABLES__ tables
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides_enriched')
                            ) or (
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('dim_stations')
                            ) or (
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_rides')
                            ) or (
                                upper(table_schema) = upper('dataeng_448500_ecobici_ds')
                            and upper(table_name) = upper('stg_stations')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMNS columns
    join `dataeng-448500`.`dataeng_448500_ecobici_ds`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m12:53:23.504492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:24.274259 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:dc82ccfc-39cf-4fc5-9630-f5f40817ad7c&page=queryresults
[0m12:53:26.030943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:26.042721 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:53:26.062213 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:53:26.063688 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:53:26.064030 [info ] [MainThread]: Catalog written to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/catalog.json
[0m12:53:26.064826 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.8937664, "process_in_blocks": "280552", "process_kernel_time": 0.497125, "process_mem_max_rss": "253204", "process_out_blocks": "6424", "process_user_time": 4.048024}
[0m12:53:26.065236 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:53:26.065144 after 5.89 seconds
[0m12:53:26.065762 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:53:26.066062 [debug] [MainThread]: Connection 'dataeng-448500.information_schema' was properly closed.
[0m12:53:26.066414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa432b67490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa429c3c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa429c3ca00>]}
[0m12:53:26.066761 [debug] [MainThread]: Flushing usage events
[0m12:53:26.726461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:28.273601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6402591460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64016fb1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64016fb970>]}


============================== 12:53:28.276746 | 8918a805-2b05-412f-b649-8b9842f9e9c1 ==============================
[0m12:53:28.276746 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:53:28.277337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve --profiles-dir .dbt --port 8081', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:29.236326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8918a805-2b05-412f-b649-8b9842f9e9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d3c11970>]}
[0m12:53:29.291766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8918a805-2b05-412f-b649-8b9842f9e9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64016fb3d0>]}
[0m12:53:30.210280 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m12:53:30.212971 [error] [MainThread]: Traceback (most recent call last):
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m12:53:30.213946 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.9962531, "process_in_blocks": "184", "process_kernel_time": 0.225928, "process_mem_max_rss": "254348", "process_out_blocks": "3352", "process_user_time": 2.9268}
[0m12:53:30.214439 [debug] [MainThread]: Command `dbt docs serve` failed at 12:53:30.214337 after 2.00 seconds
[0m12:53:30.214897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6402591460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d39f7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63d39c2dc0>]}
[0m12:53:30.215296 [debug] [MainThread]: Flushing usage events
[0m12:53:30.964126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:47.084338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2e6e4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d84f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2d84f970>]}


============================== 12:53:47.087503 | d21b2666-eb0a-498a-973c-88d54bb8ade5 ==============================
[0m12:53:47.087503 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:53:47.088207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '.dbt', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve --profiles-dir .dbt --port 8090', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:53:48.125948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd21b2666-eb0a-498a-973c-88d54bb8ade5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbffca42e0>]}
[0m12:53:48.183812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd21b2666-eb0a-498a-973c-88d54bb8ade5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2e521d90>]}
[0m12:55:48.222040 [error] [MainThread]: Encountered an error:

[0m12:55:48.225863 [error] [MainThread]: Traceback (most recent call last):
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/home/maxkaizo/miniconda3/envs/dataeng/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:55:48.226858 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 120.51395, "process_in_blocks": "192", "process_kernel_time": 0.303706, "process_mem_max_rss": "254616", "process_out_blocks": "3368", "process_user_time": 3.001969}
[0m12:55:48.227414 [debug] [MainThread]: Command `dbt docs serve` failed at 12:55:48.227296 after 120.51 seconds
[0m12:55:48.228117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2e6e4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbffb09910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbffb34be0>]}
[0m12:55:48.228863 [debug] [MainThread]: Flushing usage events
[0m12:55:48.960631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:50.258141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa38349490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa381691c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa374b48b0>]}


============================== 12:58:50.263834 | c6db1172-6e8a-4fdb-bf44-a6ac2987a978 ==============================
[0m12:58:50.263834 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:58:50.264490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select core.rides_with_stations --profiles-dir .dbt', 'send_anonymous_usage_stats': 'True'}
[0m12:58:52.130742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa3992c910>]}
[0m12:58:52.187612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa381dd7f0>]}
[0m12:58:52.188253 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m12:58:52.335945 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:58:52.411538 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:58:52.412104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa39aeb370>]}
[0m12:58:53.460899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2f43beb0>]}
[0m12:58:53.638840 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:58:53.643443 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:58:53.662416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2f4fdd90>]}
[0m12:58:53.662995 [info ] [MainThread]: Found 3 models, 2 sources, 491 macros
[0m12:58:53.663336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2f4c4f70>]}
[0m12:58:53.664346 [info ] [MainThread]: 
[0m12:58:53.664704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:53.665174 [info ] [MainThread]: 
[0m12:58:53.665664 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:58:53.666602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m12:58:53.667044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:54.469084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m12:58:54.469738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:55.064140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa39864b80>]}
[0m12:58:55.064736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:55.069432 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.rides_with_stations
[0m12:58:55.070126 [info ] [Thread-1  ]: 1 of 1 START sql table model dataeng_448500_ecobici_ds.rides_with_stations ..... [RUN]
[0m12:58:55.070595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.rides_with_stations)
[0m12:58:55.070901 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.rides_with_stations
[0m12:58:55.077802 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.rides_with_stations"
[0m12:58:55.079898 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.rides_with_stations
[0m12:58:55.107719 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.rides_with_stations"
[0m12:58:55.109821 [debug] [Thread-1  ]: On model.ecobici_dbt.rides_with_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.rides_with_stations"} */

  
    

    create or replace table `dataeng-448500`.`dataeng_448500_ecobici_ds`.`rides_with_stations`
      
    
    

    OPTIONS()
    as (
      -- models/core/rides_with_stations.sql
-- Join enriched ride data with station catalog for origin and destination context

select
  r.ride_id,
  r.source_file,
  r.ingestion_ts,

  r.bike_id,
  r.user_age,
  r.user_gender,
  r.origin_datetime,
  r.destination_datetime,
  r.ride_duration_minutes,

  -- Estación de origen
  r.origin_station_id,
  s_from.name as origin_station_name,
  s_from.lat as origin_lat,
  s_from.lon as origin_lon,

  -- Estación de destino
  r.destination_station_id,
  s_to.name as destination_station_name,
  s_to.lat as destination_lat,
  s_to.lon as destination_lon

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched` r
left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_from
  on r.origin_station_id = s_from.station_id
left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_to
  on r.destination_station_id = s_to.station_id
    );
  
[0m12:58:55.110234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:56.052886 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:c5e80fff-750d-4cd1-9184-da5b4f46dec9&page=queryresults
[0m12:58:56.616289 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:c5e80fff-750d-4cd1-9184-da5b4f46dec9&page=queryresults
[0m12:58:56.629895 [debug] [Thread-1  ]: Database Error in model rides_with_stations (models/core/rides_with_stations.sql)
  Bad int64 value: 390-391
  compiled code at target/run/ecobici_dbt/models/core/rides_with_stations.sql
[0m12:58:56.631833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6db1172-6e8a-4fdb-bf44-a6ac2987a978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa31caeb80>]}
[0m12:58:56.632486 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dataeng_448500_ecobici_ds.rides_with_stations  [[31mERROR[0m in 1.56s]
[0m12:58:56.633097 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.rides_with_stations
[0m12:58:56.633587 [debug] [Thread-4  ]: Marking all children of 'model.ecobici_dbt.rides_with_stations' to be skipped because of status 'error'.  Reason: Database Error in model rides_with_stations (models/core/rides_with_stations.sql)
  Bad int64 value: 390-391
  compiled code at target/run/ecobici_dbt/models/core/rides_with_stations.sql.
[0m12:58:56.634811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:56.636099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:56.636383 [debug] [MainThread]: Connection 'model.ecobici_dbt.rides_with_stations' was properly closed.
[0m12:58:56.636660 [info ] [MainThread]: 
[0m12:58:56.636990 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m12:58:56.637706 [debug] [MainThread]: Command end result
[0m12:58:56.659946 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m12:58:56.662363 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m12:58:56.667965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m12:58:56.668599 [info ] [MainThread]: 
[0m12:58:56.669189 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:58:56.669942 [info ] [MainThread]: 
[0m12:58:56.670481 [error] [MainThread]:   Database Error in model rides_with_stations (models/core/rides_with_stations.sql)
  Bad int64 value: 390-391
  compiled code at target/run/ecobici_dbt/models/core/rides_with_stations.sql
[0m12:58:56.670831 [info ] [MainThread]: 
[0m12:58:56.671171 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:58:56.671806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4730964, "process_in_blocks": "198600", "process_kernel_time": 0.514337, "process_mem_max_rss": "253928", "process_out_blocks": "3056", "process_user_time": 4.477762}
[0m12:58:56.672210 [debug] [MainThread]: Command `dbt run` failed at 12:58:56.672122 after 6.47 seconds
[0m12:58:56.672587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa38349490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa2f4fd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa381c8370>]}
[0m12:58:56.672943 [debug] [MainThread]: Flushing usage events
[0m12:58:57.067234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:01.569593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22dcdc5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22dcbe6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22de4c88e0>]}


============================== 13:07:01.574045 | 0ddbbd8b-e3bd-4358-a8fe-8a70fced9611 ==============================
[0m13:07:01.574045 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:07:01.574678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'profiles_dir': '.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:07:03.395408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22de3a82b0>]}
[0m13:07:03.454327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22dcb83af0>]}
[0m13:07:03.455126 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:07:03.592796 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:07:03.740387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m13:07:03.741012 [debug] [MainThread]: Partial parsing: added file: ecobici_dbt://models/core/schema.yml
[0m13:07:03.741520 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/core/rides_with_stations.sql
[0m13:07:03.741915 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_stations.sql
[0m13:07:03.742285 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_rides_enriched.sql
[0m13:07:04.076536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d413d130>]}
[0m13:07:04.141276 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m13:07:04.146572 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m13:07:04.165270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d74ddc40>]}
[0m13:07:04.165901 [info ] [MainThread]: Found 3 models, 2 sources, 491 macros
[0m13:07:04.166296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d4157ca0>]}
[0m13:07:04.167934 [info ] [MainThread]: 
[0m13:07:04.168415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:04.168732 [info ] [MainThread]: 
[0m13:07:04.169233 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:07:04.173013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m13:07:04.173463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:04.653255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m13:07:04.653981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:05.540231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22dbf88c40>]}
[0m13:07:05.540728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:05.545890 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m13:07:05.546433 [info ] [Thread-1  ]: 1 of 3 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m13:07:05.546922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m13:07:05.547234 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m13:07:05.554048 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m13:07:05.555071 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m13:07:05.576675 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m13:07:05.577424 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, local datetime and ride duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  cast(ciclo_estacion_retiro as string) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  cast(ciclo_estacion_arribo as string) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  datetime_diff(
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m13:07:05.577817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:06.452341 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:c5c6f167-ab84-4c72-bb72-a6184862f8d5&page=queryresults
[0m13:07:06.950120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d406e8e0>]}
[0m13:07:06.950897 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m13:07:06.951515 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m13:07:06.951910 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_stations
[0m13:07:06.952562 [info ] [Thread-1  ]: 2 of 3 START sql view model dataeng_448500_ecobici_ds.stg_stations ............. [RUN]
[0m13:07:06.953028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_rides_enriched, now model.ecobici_dbt.stg_stations)
[0m13:07:06.953430 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_stations
[0m13:07:06.956611 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_stations"
[0m13:07:06.957262 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_stations
[0m13:07:06.960561 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_stations"
[0m13:07:06.961228 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_stations"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations`
  OPTIONS()
  as -- models/staging/stg_stations.sql
-- Staging model for the Ecobici station catalog

select
  cast(station_id as string) as station_id,
  name,
  short_name,
  lat,
  lon,
  capacity,
  is_charging,
  has_kiosk,
  ingestion_ts
from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`dim_stations`;


[0m13:07:06.961620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:07.575425 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:6f8d1533-4bd5-45e2-a905-2f4bebabdafb&page=queryresults
[0m13:07:08.205426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22dcc66670>]}
[0m13:07:08.206163 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dataeng_448500_ecobici_ds.stg_stations ........ [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m13:07:08.206997 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_stations
[0m13:07:08.208120 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.rides_with_stations
[0m13:07:08.208650 [info ] [Thread-1  ]: 3 of 3 START sql table model dataeng_448500_ecobici_ds.rides_with_stations ..... [RUN]
[0m13:07:08.209186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_stations, now model.ecobici_dbt.rides_with_stations)
[0m13:07:08.209575 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.rides_with_stations
[0m13:07:08.213679 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.rides_with_stations"
[0m13:07:08.214552 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.rides_with_stations
[0m13:07:08.243007 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.rides_with_stations"
[0m13:07:08.243798 [debug] [Thread-1  ]: On model.ecobici_dbt.rides_with_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.rides_with_stations"} */

  
    

    create or replace table `dataeng-448500`.`dataeng_448500_ecobici_ds`.`rides_with_stations`
      
    
    

    OPTIONS()
    as (
      -- models/core/rides_with_stations.sql
-- Join enriched ride data with station catalog for origin and destination context

select
  r.ride_id,
  r.source_file,
  r.ingestion_ts,

  r.bike_id,
  r.user_age,
  r.user_gender,
  r.origin_datetime,
  r.destination_datetime,
  r.ride_duration_minutes,

  -- Estación de origen
  r.origin_station_id,
  s_from.name as origin_station_name,
  s_from.lat as origin_lat,
  s_from.lon as origin_lon,

  -- Estación de destino
  r.destination_station_id,
  s_to.name as destination_station_name,
  s_to.lat as destination_lat,
  s_to.lon as destination_lon

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched` r
left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_from
  on r.origin_station_id = s_from.station_id

left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_to
  on r.destination_station_id = s_to.station_id
    );
  
[0m13:07:08.244224 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:09.134572 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:2eb3064e-a2bd-4421-964b-66d6fc24becc&page=queryresults
[0m13:07:15.816725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ddbbd8b-e3bd-4358-a8fe-8a70fced9611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ae39ef70>]}
[0m13:07:15.817437 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dataeng_448500_ecobici_ds.rides_with_stations  [[32mCREATE TABLE (5.5m rows, 854.2 MiB processed)[0m in 7.61s]
[0m13:07:15.818087 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.rides_with_stations
[0m13:07:15.819467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:15.820815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:15.821104 [debug] [MainThread]: Connection 'model.ecobici_dbt.rides_with_stations' was properly closed.
[0m13:07:15.821441 [info ] [MainThread]: 
[0m13:07:15.821761 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 11.65 seconds (11.65s).
[0m13:07:15.822585 [debug] [MainThread]: Command end result
[0m13:07:15.844090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m13:07:15.845763 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m13:07:15.850605 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m13:07:15.850911 [info ] [MainThread]: 
[0m13:07:15.851327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:07:15.851654 [info ] [MainThread]: 
[0m13:07:15.852019 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:07:15.852601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.168728, "process_in_blocks": "276984", "process_kernel_time": 0.581888, "process_mem_max_rss": "258396", "process_out_blocks": "3120", "process_user_time": 4.018599}
[0m13:07:15.853023 [debug] [MainThread]: Command `dbt run` succeeded at 13:07:15.852902 after 14.17 seconds
[0m13:07:15.853371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22dcdc5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22de3a82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22d74ddc40>]}
[0m13:07:15.853746 [debug] [MainThread]: Flushing usage events
[0m13:07:16.636877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:23.509378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d46f24430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d46d45fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d486278e0>]}


============================== 13:26:23.514589 | 88860d1b-6fc1-4835-944d-12285abb6338 ==============================
[0m13:26:23.514589 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:26:23.515135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '.dbt', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .dbt', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:25.679856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d485072b0>]}
[0m13:26:25.743796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d486664f0>]}
[0m13:26:25.744677 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:26:25.934168 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:26:26.081852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:26:26.082456 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_rides_enriched.sql
[0m13:26:26.444056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3e141130>]}
[0m13:26:26.511306 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m13:26:26.516385 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m13:26:26.538426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d414e0e50>]}
[0m13:26:26.539025 [info ] [MainThread]: Found 3 models, 2 sources, 491 macros
[0m13:26:26.539436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3e1413d0>]}
[0m13:26:26.541358 [info ] [MainThread]: 
[0m13:26:26.541776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:26.542115 [info ] [MainThread]: 
[0m13:26:26.542677 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:26:26.547156 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m13:26:26.547830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:27.615921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m13:26:27.616487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:28.727939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d48446730>]}
[0m13:26:28.728616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:28.734842 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m13:26:28.735459 [info ] [Thread-1  ]: 1 of 3 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m13:26:28.735945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m13:26:28.736273 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m13:26:28.742747 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m13:26:28.744278 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m13:26:28.765778 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m13:26:28.766566 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, local datetime and ride duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  ltrim(ciclo_estacion_retiro, '0') as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  ltrim(ciclo_estacion_arribo, '0') as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  datetime_diff(
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m13:26:28.766955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:29.962417 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:ec1e32f7-a926-4f64-ba79-6510e9f0137b&page=queryresults
[0m13:26:30.494595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d397d9d00>]}
[0m13:26:30.495392 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m13:26:30.495926 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m13:26:30.496299 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_stations
[0m13:26:30.496904 [info ] [Thread-1  ]: 2 of 3 START sql view model dataeng_448500_ecobici_ds.stg_stations ............. [RUN]
[0m13:26:30.497357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_rides_enriched, now model.ecobici_dbt.stg_stations)
[0m13:26:30.497698 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_stations
[0m13:26:30.500458 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_stations"
[0m13:26:30.501184 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_stations
[0m13:26:30.503745 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_stations"
[0m13:26:30.504440 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_stations"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations`
  OPTIONS()
  as -- models/staging/stg_stations.sql
-- Staging model for the Ecobici station catalog

select
  cast(station_id as string) as station_id,
  name,
  short_name,
  lat,
  lon,
  capacity,
  is_charging,
  has_kiosk,
  ingestion_ts
from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`dim_stations`;


[0m13:26:30.504794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:31.212049 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:65589818-883b-4ce3-a423-7c767f68c4e5&page=queryresults
[0m13:26:31.516566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d397d9d00>]}
[0m13:26:31.517307 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dataeng_448500_ecobici_ds.stg_stations ........ [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m13:26:31.517957 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_stations
[0m13:26:31.519041 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.rides_with_stations
[0m13:26:31.519591 [info ] [Thread-1  ]: 3 of 3 START sql table model dataeng_448500_ecobici_ds.rides_with_stations ..... [RUN]
[0m13:26:31.520029 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_stations, now model.ecobici_dbt.rides_with_stations)
[0m13:26:31.520370 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.rides_with_stations
[0m13:26:31.523665 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.rides_with_stations"
[0m13:26:31.524273 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.rides_with_stations
[0m13:26:31.537339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:32.114199 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.rides_with_stations"
[0m13:26:32.115062 [debug] [Thread-1  ]: On model.ecobici_dbt.rides_with_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.rides_with_stations"} */

  
    

    create or replace table `dataeng-448500`.`dataeng_448500_ecobici_ds`.`rides_with_stations`
      
    
    

    OPTIONS()
    as (
      -- models/core/rides_with_stations.sql
-- Join enriched ride data with station catalog for origin and destination context

select
  r.ride_id,
  r.source_file,
  r.ingestion_ts,

  r.bike_id,
  r.user_age,
  r.user_gender,
  r.origin_datetime,
  r.destination_datetime,
  r.ride_duration_minutes,

  -- Estación de origen
  r.origin_station_id,
  s_from.name as origin_station_name,
  s_from.lat as origin_lat,
  s_from.lon as origin_lon,

  -- Estación de destino
  r.destination_station_id,
  s_to.name as destination_station_name,
  s_to.lat as destination_lat,
  s_to.lon as destination_lon

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched` r
left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_from
  on r.origin_station_id = s_from.station_id

left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_to
  on r.destination_station_id = s_to.station_id
    );
  
[0m13:26:32.846404 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:955cf51e-239e-45a7-ad54-25590fa1009f&page=queryresults
[0m13:27:19.752212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88860d1b-6fc1-4835-944d-12285abb6338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d18506bb0>]}
[0m13:27:19.753714 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dataeng_448500_ecobici_ds.rides_with_stations  [[32mCREATE TABLE (5.5m rows, 854.2 MiB processed)[0m in 48.23s]
[0m13:27:19.754341 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.rides_with_stations
[0m13:27:19.756654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:19.758631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:19.758950 [debug] [MainThread]: Connection 'model.ecobici_dbt.rides_with_stations' was properly closed.
[0m13:27:19.759384 [info ] [MainThread]: 
[0m13:27:19.759708 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 53.22 seconds (53.22s).
[0m13:27:19.760579 [debug] [MainThread]: Command end result
[0m13:27:19.783620 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m13:27:19.786715 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m13:27:19.793191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m13:27:19.793577 [info ] [MainThread]: 
[0m13:27:19.794325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:19.794684 [info ] [MainThread]: 
[0m13:27:19.795035 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:27:19.795610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 56.0088, "process_in_blocks": "277416", "process_kernel_time": 0.880384, "process_mem_max_rss": "260904", "process_out_blocks": "3120", "process_user_time": 4.184005}
[0m13:27:19.796103 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:19.796014 after 56.01 seconds
[0m13:27:19.796458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d46f24430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3e0fd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3e0fd160>]}
[0m13:27:19.796810 [debug] [MainThread]: Flushing usage events
[0m13:27:20.471713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:20.642949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d359c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d26b7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d26b73a0>]}


============================== 13:36:20.647161 | 0c8fd7eb-ef45-49e1-8e31-2197df707fa4 ==============================
[0m13:36:20.647161 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:36:20.647801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/maxkaizo/cdmx_ecobici_usage/tests/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .dbt', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:36:22.764152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d2773280>]}
[0m13:36:22.822761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a4be96d0>]}
[0m13:36:22.823477 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m13:36:22.965629 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:36:23.114767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:36:23.115434 [debug] [MainThread]: Partial parsing: updated file: ecobici_dbt://models/staging/stg_rides_enriched.sql
[0m13:36:23.443410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ca942130>]}
[0m13:36:23.504992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m13:36:23.510210 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m13:36:23.529824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ca9a0580>]}
[0m13:36:23.530314 [info ] [MainThread]: Found 3 models, 2 sources, 491 macros
[0m13:36:23.530667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ca94eb50>]}
[0m13:36:23.532076 [info ] [MainThread]: 
[0m13:36:23.532537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:36:23.532941 [info ] [MainThread]: 
[0m13:36:23.533521 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:36:23.537079 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dataeng-448500'
[0m13:36:23.537593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:24.288472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dataeng-448500, now list_dataeng-448500_dataeng_448500_ecobici_ds)
[0m13:36:24.288991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:36:24.971873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ca9c9760>]}
[0m13:36:24.972613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:24.978448 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_rides_enriched
[0m13:36:24.979058 [info ] [Thread-1  ]: 1 of 3 START sql view model dataeng_448500_ecobici_ds.stg_rides_enriched ....... [RUN]
[0m13:36:24.979604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dataeng-448500_dataeng_448500_ecobici_ds, now model.ecobici_dbt.stg_rides_enriched)
[0m13:36:24.979987 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_rides_enriched
[0m13:36:24.987560 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_rides_enriched"
[0m13:36:24.988754 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_rides_enriched
[0m13:36:25.019849 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_rides_enriched"
[0m13:36:25.020706 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_rides_enriched: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_rides_enriched"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched`
  OPTIONS()
  as -- models/staging/stg_rides_enriched.sql
-- Enriched version of raw ride data with typed fields, local datetime and ride duration

select
  -- Technical identifiers
  ride_id,
  source_file,
  ingestion_ts,

  -- Bike information
  cast(bici as int64) as bike_id,

  -- Origin station
  trim(split(ltrim(ciclo_estacion_retiro, '0'), '-')[safe_offset(0)]) as origin_station_id,
  fecha_retiro as origin_date,
  hora_retiro as origin_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)) as origin_datetime,

  -- Destination station
  trim(split(ltrim(ciclo_estacion_arribo, '0'), '-')[safe_offset(0)]) as destination_station_id,
  fecha_arribo as destination_date,
  hora_arribo as destination_time,
  safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)) as destination_datetime,

  -- User info
  cast(edad_usuario as int64) as user_age,
  genero_usuario as user_gender,

  -- Ride duration in minutes
  datetime_diff(
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_arribo, ' ', hora_arribo)),
    safe.parse_datetime('%d/%m/%Y %H:%M:%S', concat(fecha_retiro, ' ', hora_retiro)),
    minute
  ) as ride_duration_minutes

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides`
where
  fecha_retiro is not null
  and hora_retiro is not null
  and fecha_arribo is not null
  and hora_arribo is not null;


[0m13:36:25.021154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:25.914527 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:33130487-2e9b-4469-9170-d8aa37c91cde&page=queryresults
[0m13:36:26.446521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ca97bac0>]}
[0m13:36:26.447356 [info ] [Thread-1  ]: 1 of 3 OK created sql view model dataeng_448500_ecobici_ds.stg_rides_enriched .. [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m13:36:26.448015 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_rides_enriched
[0m13:36:26.448425 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.stg_stations
[0m13:36:26.449053 [info ] [Thread-1  ]: 2 of 3 START sql view model dataeng_448500_ecobici_ds.stg_stations ............. [RUN]
[0m13:36:26.449524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_rides_enriched, now model.ecobici_dbt.stg_stations)
[0m13:36:26.449842 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.stg_stations
[0m13:36:26.452455 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.stg_stations"
[0m13:36:26.453080 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.stg_stations
[0m13:36:26.456048 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.stg_stations"
[0m13:36:26.456615 [debug] [Thread-1  ]: On model.ecobici_dbt.stg_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.stg_stations"} */


  create or replace view `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations`
  OPTIONS()
  as -- models/staging/stg_stations.sql
-- Staging model for the Ecobici station catalog

select
  cast(station_id as string) as station_id,
  name,
  short_name,
  lat,
  lon,
  capacity,
  is_charging,
  has_kiosk,
  ingestion_ts
from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`dim_stations`;


[0m13:36:26.456968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:27.135373 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:5f00f774-0e4b-4319-9d4b-aa598441defc&page=queryresults
[0m13:36:27.500336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d375aac0>]}
[0m13:36:27.501094 [info ] [Thread-1  ]: 2 of 3 OK created sql view model dataeng_448500_ecobici_ds.stg_stations ........ [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m13:36:27.501690 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.stg_stations
[0m13:36:27.502958 [debug] [Thread-1  ]: Began running node model.ecobici_dbt.rides_with_stations
[0m13:36:27.503509 [info ] [Thread-1  ]: 3 of 3 START sql table model dataeng_448500_ecobici_ds.rides_with_stations ..... [RUN]
[0m13:36:27.504045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecobici_dbt.stg_stations, now model.ecobici_dbt.rides_with_stations)
[0m13:36:27.504427 [debug] [Thread-1  ]: Began compiling node model.ecobici_dbt.rides_with_stations
[0m13:36:27.508355 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecobici_dbt.rides_with_stations"
[0m13:36:27.509051 [debug] [Thread-1  ]: Began executing node model.ecobici_dbt.rides_with_stations
[0m13:36:27.520736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:36:28.044174 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecobici_dbt.rides_with_stations"
[0m13:36:28.044896 [debug] [Thread-1  ]: On model.ecobici_dbt.rides_with_stations: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "ecobici_profile", "target_name": "dev", "node_id": "model.ecobici_dbt.rides_with_stations"} */

  
    

    create or replace table `dataeng-448500`.`dataeng_448500_ecobici_ds`.`rides_with_stations`
      
    
    

    OPTIONS()
    as (
      -- models/core/rides_with_stations.sql
-- Join enriched ride data with station catalog for origin and destination context

select
  r.ride_id,
  r.source_file,
  r.ingestion_ts,

  r.bike_id,
  r.user_age,
  r.user_gender,
  r.origin_datetime,
  r.destination_datetime,
  r.ride_duration_minutes,

  -- Estación de origen
  r.origin_station_id,
  s_from.name as origin_station_name,
  s_from.lat as origin_lat,
  s_from.lon as origin_lon,

  -- Estación de destino
  r.destination_station_id,
  s_to.name as destination_station_name,
  s_to.lat as destination_lat,
  s_to.lon as destination_lon

from `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_rides_enriched` r
left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_from
  on r.origin_station_id = s_from.station_id

left join `dataeng-448500`.`dataeng_448500_ecobici_ds`.`stg_stations` s_to
  on r.destination_station_id = s_to.station_id
    );
  
[0m13:36:28.636523 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dataeng-448500&j=bq:us-central1:abaef3b3-2169-4f94-a5a0-854b10769d98&page=queryresults
[0m13:36:34.996746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c8fd7eb-ef45-49e1-8e31-2197df707fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a4b6cd00>]}
[0m13:36:34.997400 [info ] [Thread-1  ]: 3 of 3 OK created sql table model dataeng_448500_ecobici_ds.rides_with_stations  [[32mCREATE TABLE (5.5m rows, 854.2 MiB processed)[0m in 7.49s]
[0m13:36:34.997943 [debug] [Thread-1  ]: Finished running node model.ecobici_dbt.rides_with_stations
[0m13:36:34.999349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:35.000767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:35.001047 [debug] [MainThread]: Connection 'model.ecobici_dbt.rides_with_stations' was properly closed.
[0m13:36:35.001383 [info ] [MainThread]: 
[0m13:36:35.001700 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 11.47 seconds (11.47s).
[0m13:36:35.002521 [debug] [MainThread]: Command end result
[0m13:36:35.023087 [debug] [MainThread]: Wrote artifact WritableManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/manifest.json
[0m13:36:35.024766 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/semantic_manifest.json
[0m13:36:35.029790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/maxkaizo/cdmx_ecobici_usage/tests/dbt/target/run_results.json
[0m13:36:35.030200 [info ] [MainThread]: 
[0m13:36:35.030581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:35.030875 [info ] [MainThread]: 
[0m13:36:35.031238 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:36:35.031809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.449097, "process_in_blocks": "276984", "process_kernel_time": 0.59285, "process_mem_max_rss": "258572", "process_out_blocks": "3128", "process_user_time": 4.3135}
[0m13:36:35.032169 [debug] [MainThread]: Command `dbt run` succeeded at 13:36:35.032086 after 14.45 seconds
[0m13:36:35.032528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16d359c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16a4be96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ca905ee0>]}
[0m13:36:35.033039 [debug] [MainThread]: Flushing usage events
[0m13:36:35.461890 [debug] [MainThread]: An error was encountered while trying to flush usage events
